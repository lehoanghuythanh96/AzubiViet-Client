"use strict";(self.webpackChunkazubi_client=self.webpackChunkazubi_client||[]).push([[230],{5230:(lt,O,l)=>{l.r(O),l.d(O,{AdminAreaModule:()=>st});var C=l(8583),p=l(665),V=l(1554),W=l(346),y=l(1095),Y=l(3738),K=l(7539),E=l(8341),H=l(2458),ee=l(3220),te=l(1769),oe=l(171),u=l(8295),w=l(9983),x=l(3935),Q=l(2178),J=l(7441),N=l(3017),L=l(7001),se=l(1436),ae=l(7360),B=l(9273),Z=l(9765),f=l(6782),v=l(7164),ie=l(5855),e=l(7716),T=l(3065),ne=l(6215);let I=(()=>{class o{constructor(){this.addlesson={area_ID:null,cat_ID:[],neworedit:!0,editID:0},this._lessonarea$=new Z.xQ,this.editlesson$=new Z.xQ,this.admininfo$=new ne.X(void 0)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),le=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-left-sidebar"]],decls:2,vars:0,template:function(t,s){1&t&&(e.TgZ(0,"p"),e._uU(1,"left-sidebar works!"),e.qZA())},styles:[""]}),o})();var S=l(8007);let re=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-header"]],decls:5,vars:0,consts:[[1,"container-fluid","sticky-top"],[1,"row","py-2","justify-content-between"],[1,"col-auto"],["mat-button","","routerLink","/"],[1,"fa-thin","fa-house"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"button",3),e._UZ(4,"i",4),e.qZA(),e.qZA(),e.qZA(),e.qZA())},directives:[y.lW,S.rH],styles:[".container-fluid[_ngcontent-%COMP%]{background:rgba(255,255,255,.5);box-shadow:0 8px 32px #dfe1fa5e;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);border:1px solid rgba(255,255,255,.18)}"]}),o})(),ce=(()=>{class o{constructor(t,s){this.store=t,this.localService=s,this.destroy$=new Z.xQ}ngOnInit(){this.store.dispatch((0,v.x)()),this.store.select(ie.s).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.localService.admininfo$.next(t.admininfo)})}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.yh),e.Y36(I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-admin-area-layout"]],decls:7,vars:2,consts:[["autosize","","hasBackdrop","false"],[3,"opened","mode"],["leftdrawer",""],[3,"click"]],template:function(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"mat-drawer-container",0),e.TgZ(1,"mat-drawer",1,2),e._UZ(3,"app-left-sidebar"),e.qZA(),e.TgZ(4,"mat-drawer-content"),e.TgZ(5,"app-header",3),e.NdJ("click",function(){return e.CHM(i),e.MAs(2).toggle()}),e.qZA(),e._UZ(6,"router-outlet"),e.qZA(),e.qZA()}2&t&&(e.xp6(1),e.Q6J("opened",!1)("mode","over"))},directives:[N.kh,N.jA,le,N.LW,re,S.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh}mat-drawer-container[_ngcontent-%COMP%]{height:inherit}mat-drawer-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]{padding:.5rem;box-shadow:none;background:transparent}mat-drawer-content[_ngcontent-%COMP%]{overflow-x:hidden}"]}),o})();var D=l(2340),de=l(2161),U=l.n(de),c_ID_SPLIT_FLAG="__ID_SPLIT__",c_QUILL_UPLOAD_HOLDER_CLASS_NAME="quill-upload-progress",c_DEFAULT_STYLES="\n    .quill-progress-wrapper {\n      height: 0.25rem;\n      position: relative;\n      background: #f3efe6;\n      overflow: hidden;\n      margin-top: 0;\n    }\n\n    .quill-progress-wrapper span {\n      display: block;\n      height: 100%;\n    }\n\n    .quill-progress {\n      background-color: #3498db;\n      animation: progressBar 10s ease-in-out;\n      animation-fill-mode:both;\n    }\n\n    @keyframes progressBar {\n      0% { width: 0; }\n      100% { width: 100%; }\n    }\n\n    .d-none {\n      display: none;\n    }\n\n    .quill-upload-progress {\n      opacity: 0.3;\n    }\n  ",c_blots={video:"video",image:"image"},c_LOADING_CLASS_NAME="quill-progress-wrapper",c_NONE_DISPLAY_CLASS_NAME="d-none";class pe{constructor(){this.id=0,this.prefix="QUILL_UPLOAD_HANDLER"}generateID(){const a=this.id;return this.id=a+1,`${this.prefix}-${a}`}loadingHTML(){return`<div id="${c_ID_SPLIT_FLAG}.QUILL-LOADING">\n                        <span style="width:90%;"><span class="quill-progress">\n                        </span></span>\n                      </div>`}}class ue{constructor(a){this.styles=a,this.setUp()}setUp(){this.eStyle=document.createElement("style"),this.eStyle.type="text/css",document.getElementsByTagName("head")[0].appendChild(this.eStyle)}setStyle(a){this.styles=a}apply(){this.eStyle.appendChild(document.createTextNode(this.styles||c_DEFAULT_STYLES))}}const he=U().import("formats/image"),j=["alt","height","width","style"];class q extends he{static create(a){let t,s;if("object"==typeof a&&!a.url)return super.create();const i=a.url?a.url.split(c_ID_SPLIT_FLAG):a.split(c_ID_SPLIT_FLAG);i.length>1?(t=i[0],s=i[1]):s=a;const n=super.create(s);return"string"==typeof s&&n.setAttribute("src",s),"object"==typeof s&&n.setAttribute("src",s.url),t&&n.setAttribute("id",t),n}static value(a){return{alt:a.getAttribute("alt"),url:a.getAttribute("src")}}static formats(a){return j.reduce(function(t,s){return a.hasAttribute(s)&&(t[s]=a.getAttribute(s)),t},{})}format(a,t){j.indexOf(a)>-1?t?this.domNode.setAttribute(a,t):this.domNode.removeAttribute(a):super.format(a,t)}}q.tagName="img",q.blotName=c_blots.image,q.className="quill-upload-image";const _e=U().import("blots/block/embed");class F extends _e{static create(a){let t,s;if("object"==typeof a&&!a.url)return super.create();const i=a.url?a.url.split(c_ID_SPLIT_FLAG):a.split(c_ID_SPLIT_FLAG);i.length>1?(t=i[0],s=i[1]):s=a;const n=super.create(s);return"string"==typeof s&&n.setAttribute("src",s),"object"==typeof s&&n.setAttribute("src",s.url),t&&n.setAttribute("id",t),n.setAttribute("controls",!0),n.setAttribute("controlsList","nodownload"),n.setAttribute("width","100%"),n}static formats(a){const t={};return a.hasAttribute("height")&&(t.height=a.getAttribute("height")),a.hasAttribute("width")&&(t.width=a.getAttribute("width")),t}static value(a){return a.getAttribute("src")}format(a,t){"height"===a||"width"===a?t?this.domNode.setAttribute(a,t):this.domNode.removeAttribute(a,t):super.format(a,t)}}F.tagName="video",F.blotName=c_blots.video,F.className="quill-upload-video";var m=l(1841),M=l(6888),be=l(728),P=l(9786);function ye(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"p"),e.TgZ(1,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw()._newLesson()}),e._UZ(2,"i",26),e.TgZ(3,"span"),e._uU(4,"New Lesson"),e.qZA(),e.qZA(),e.qZA()}}function ve(o,a){1&o&&(e.TgZ(0,"h3"),e._uU(1,"New Lesson:"),e.qZA())}function Ze(o,a){if(1&o&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Edit Lesson number: ",t.editID,"")}}function Te(o,a){if(1&o&&(e.TgZ(0,"div",27),e.TgZ(1,"div",4),e.TgZ(2,"p"),e.TgZ(3,"strong"),e._uU(4,"Current avatar:"),e.qZA(),e.qZA(),e._UZ(5,"img",28),e.qZA(),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.Q6J("src",t.cdnfolder+t.lessonForm.value.post_avatar,e.LSH)}}function Ce(o,a){1&o&&(e.TgZ(0,"mat-hint"),e.TgZ(1,"span",29),e._uU(2,"Image uploaded successfully"),e.qZA(),e.qZA())}function Ie(o,a){if(1&o&&e._UZ(0,"mat-progress-bar",30),2&o){const t=e.oxw();e.Q6J("value",t.upimgformpercent)}}function Se(o,a){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.uploadimgbyfileinfo," ")}}function we(o,a){1&o&&(e.TgZ(0,"div"),e._UZ(1,"mat-progress-bar",31),e.qZA())}function Le(o,a){1&o&&(e.TgZ(0,"mat-hint"),e.TgZ(1,"span",29),e._uU(2,"Image uploaded successfully"),e.qZA(),e.qZA())}function xe(o,a){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.uploadimgbyurlinfo," ")}}function Ne(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().publish()}),e._uU(1," Publish lesson "),e.qZA()}}function De(o,a){1&o&&e._UZ(0,"mat-progress-bar",31)}U().register("modules/imageHandler",class extends class{constructor(a,t){if(this.helpers=new pe,this.quill=a,this.options=t,this.range=null,(new ue).apply(),this.isNotExistLoading()){const s=document.createElement("div");s.innerHTML=this.helpers.loadingHTML(),this.quill.container.appendChild(s)}"function"!=typeof this.options.upload&&console.warn("[Missing config] upload function that returns a promise is required"),setTimeout(()=>{this.options.accepts||(this.handler===c_blots.image&&(this.options.accepts=["jpg","jpeg","png"]),this.handler===c_blots.video&&(this.options.accepts=["mp4","webm"])),this.handler===c_blots.image&&(this.possibleExtension=new Set(["apng","bmp","gif","ico","cur","jpg","jpeg","jfif","pjpeg","pjp","png","svg","tif","tiff","webp"])),this.handler===c_blots.video&&(this.possibleExtension=new Set(["mp4","webm","3gp","mp4","mpeg","quickTime","ogg"])),this.allowedFormatRegex=new RegExp("^("+this.options.accepts.filter(s=>this.possibleExtension.has(s.toLowerCase())).reduce((s,i,n)=>s.concat(0!==n?`|${i}`:`${i}`),"")+")$","i")},1)}applyForToolbar(){const a=this.quill.getModule("toolbar");this.loading=document.getElementById(`${c_ID_SPLIT_FLAG}.QUILL-LOADING`),a.addHandler(this.handler,this.selectLocalFile.bind(this))}selectLocalFile(){this.range=this.quill.getSelection(),this.fileHolder=document.createElement("input"),this.fileHolder.setAttribute("type","file"),this.fileHolder.setAttribute("accept",`${this.handler}/*`),this.fileHolder.onchange=this.fileChanged.bind(this),this.fileHolder.click()}loadFile(a){this.loading.removeAttribute("class"),this.loading.setAttribute("class",c_LOADING_CLASS_NAME);const t=a.fileHolder.files[0];this.handlerId=this.helpers.generateID();const s=new FileReader;return s.addEventListener("load",()=>{this.insertBase64Data(s.result,this.handlerId)},!1),t?(s.readAsDataURL(t),{file:t,handlerId:this.handlerId}):(console.warn("[File not found] Something was wrong, please try again!!"),null)}fileChanged(){const{file:a,handlerId:t}=this.loadFile(this);if(!a)return;const s=a.name.split(".").pop();this.isValidExtension(s)||console.warn("[Wrong Format] Format was wrong, please try with correct format!!"),this.hasValidMimeType(a.type)||console.warn(`[Incorrect Mime Type] The MIME Type of uploaded file is not ${this.handler}!!`),this.embedFile(a,t)}embedFile(a,t){this.options.upload(a).then(s=>{this.insertFileToEditor(s,t),this.loading.removeAttribute("class"),this.loading.setAttribute("class",c_NONE_DISPLAY_CLASS_NAME)},s=>{this.loading.removeAttribute("class"),this.loading.setAttribute("class",c_NONE_DISPLAY_CLASS_NAME),setTimeout(()=>{document.getElementById(t).remove()},1e3)})}insertBase64Data(a,t){this.quill.insertEmbed(this.range.index,this.handler,`${t}${c_ID_SPLIT_FLAG}${a}`);const i=document.getElementById(t);i&&i.setAttribute("class",c_QUILL_UPLOAD_HOLDER_CLASS_NAME)}insertFileToEditor(a,t){const s=document.getElementById(t);s&&(s.setAttribute("src",a),s.removeAttribute("id"),s.removeAttribute("class"))}isValidExtension(a){return a&&this.allowedFormatRegex.test(a)}hasValidMimeType(a){return a&&a.startsWith(this.handler)}isNotExistLoading(){return null==document.getElementById(`${c_ID_SPLIT_FLAG}.QUILL-LOADING`)}}{constructor(a,t){super(a,t),this.handler=c_blots.image,this.applyForToolbar(),U().register(q,!0)}});let G=(()=>{class o{constructor(t,s,i,n,r){this._UploadImg=t,this._snackbar=s,this._localService=i,this._APIservice=n,this.store=r,this.publishloading=!1,this.lessonForm=new p.cw({post_title:new p.NI("",[p.kI.required,p.kI.maxLength(255)]),post_content:new p.NI("",[p.kI.required]),post_avatar:new p.NI("",[p.kI.required])}),this.postimgs=[],this.destroy$=new Z.xQ,this.modules={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]],imageHandler:{upload:d=>new Promise((_,b)=>{if("image/jpeg"===d.type||"image/png"===d.type||"image/jpg"===d.type)if(d.size<1e7){const X="lesson_image";let at={inputfile:d,upload_url_suffix:"uploadlessonimage",FileObjName:X,param_variables:(new m.LE).set("file_obj_name",X).set("file_size",parseInt(d.size))};this._UploadImg.uploadfile(at).subscribe(A=>{switch(A.type){case m.dt.Sent:console.log("Request has been made!");break;case m.dt.ResponseHeader:console.log("Response header has been received!");break;case m.dt.UploadProgress:var nt=Math.round(A.loaded/(A.total?A.total:0)*100);console.log(`Uploaded ${nt}%`);break;case m.dt.Response:console.log("Image Uploaded Successfully!",A.body),_(D.N.BASE_API_URL+"/"+A.body.newFilepath)}},A=>{console.log("Image not Uploaded!",A.error),this._snackbar.open(A.error.message,"Close"),b(A.message)})}else b("Size too large");else b("Unsupported type")}),accepts:["png","jpg","jpeg","jfif"]}},this.uploadimgbyfiletoggle=!1,this.uploadimgbyfilesuccess=!1,this.upimgformpercent=0,this.uploadimgbyfileerror=!1,this.uploadimgbyfileinfo="",this.uploadimgbyurltoggle=!1,this.uploadimgbyurlinfo="",this.uploadimgbyurlerror=!1,this.uploadimgbyurlsuccess=!1}get neworedit(){return this._localService.addlesson.neworedit}get editID(){return this._localService.addlesson.editID}ngOnInit(){this._localService.admininfo$.pipe((0,f.R)(this.destroy$),(0,M.n)(t=>!(null==t?void 0:t.admininfo))).subscribe(t=>{var s,i;let n=t.admininfo;this.cdnfolder=D.N.BASE_CDN_URL+"/"+(null===(s=n.defaultconfig)||void 0===s?void 0:s.postimg_path),this.default_avatar=null===(i=n.defaultconfig)||void 0===i?void 0:i.default_post_avatar}),this._localService.editlesson$.pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.lessonForm.controls.post_title.setValue(t.post_title),this.lessonForm.controls.post_content.setValue(t.post_content),this.lessonForm.controls.post_avatar.setValue(t.post_avatar!=this.default_avatar?t.post_avatar:"")})}_newLesson(){this._localService.addlesson.neworedit=!0,this._localService.editlesson$.next({post_title:"",post_content:"",post_category:[],post_imgarr:[],post_avatar:""})}ngOnDestroy(){this.destroy$.next(!1),this.destroy$.unsubscribe()}publish(){if(this.scaneditorimg(),this._localService.addlesson.area_ID&&this._localService.addlesson.cat_ID&&this.lessonForm.valid)if(1==this._localService.addlesson.neworedit){let s={urlsuffix:"publishnewlesson",body:{post_title:this.lessonForm.value.post_title,post_content:this.lessonForm.value.post_content,post_category:this._localService.addlesson.cat_ID,post_imgarr:this.postimgs,post_avatar:this.lessonForm.value.post_avatar}};this.publishloading=!0,this._APIservice.postAPI(s).then(i=>{this.publishloading=!1,this.store.dispatch((0,v.x)()),this._newLesson(),this._snackbar.open("Published successfully!","Close")}).catch(i=>{this.publishloading=!1,console.log(i.error),this._snackbar.open(i.error.message,"Close")})}else{let s={urlsuffix:"editsinglelesson",body:{post_title:this.lessonForm.value.post_title,post_content:this.lessonForm.value.post_content,post_category:this._localService.addlesson.cat_ID,post_imgarr:this.postimgs,ID:this.editID,post_avatar:this.lessonForm.value.post_avatar}};this.publishloading=!0,this._APIservice.postAPI(s).then(i=>{this.publishloading=!1,this.store.dispatch((0,v.x)()),this._newLesson(),this._snackbar.open("Updated successfully!","Close")}).catch(i=>{this.publishloading=!1,console.log(i.error),this._snackbar.open(i.error.message,"Close")})}else this._snackbar.open("Please fill out all the content first...","Close")}scaneditorimg(){this.postimgs=[];var t=document.createElement("html");t.innerHTML=this.lessonForm.value.post_content;for(var s=t.querySelectorAll("img"),i=0;i<s.length;i++){let b,r=s[i].getAttribute("src");b=r.split("//")[1].split("/")[0]==D.N.BASE_CDN_URL.split("//")[1];var n=r.substring(r.lastIndexOf("/")+1);this.postimgs.push({name:n,link:r,isOrigin:b})}}uploadfile(t){if(this.lessonForm.controls.post_avatar.setValue(""),this.uploadimgbyfilesuccess=!1,this.uploadimgbyfileerror=!1,1==t.files.length){const s="Post_Avatar";let i={upload_url_suffix:"uploadlessonavatarbyimgfile",inputfile:t.files[0],FileObjName:s,param_variables:(new m.LE).set("file_obj_name",s).set("file_size",parseInt(t.files[0].size))};this._UploadImg.uploadfile(i).subscribe(n=>{switch(n.type){case m.dt.Sent:this.uploadimgbyfiletoggle=!0,console.log("Request has been made!");break;case m.dt.ResponseHeader:console.log("Response header has been received!");break;case m.dt.UploadProgress:var d=Math.round(n.loaded/(n.total?n.total:0)*100);this.upimgformpercent=d,console.log(`Uploaded ${d}%`);break;case m.dt.Response:this.uploadimgbyfilesuccess=!0,this.uploadimgbyfiletoggle=!1,this.lessonForm.controls.post_avatar.setValue(n.body.newFilename),console.log("Image Uploaded Successfully!",n.body)}},n=>{console.log("Image not Uploaded!"),this.uploadimgbyfiletoggle=!1,this.uploadimgbyfileerror=!0,this.uploadimgbyfileinfo=n.error.message})}else this.uploadimgbyfileinfo="This image is too large, maximal 25MB..."}uploadfilebyurl(t){this.uploadimgbyurlsuccess=!1,this.uploadimgbyurlerror=!1,""!==t&&(this.lessonForm.controls.post_avatar.setValue(""),this._UploadImg.uploadfilebyurl({body:{img_url:t},upload_url_suffix:"uploadlessonavatarbyurl"}).subscribe(n=>{switch(n.type){case m.dt.Sent:this.uploadimgbyurltoggle=!0,console.log("Request has been made!");break;case m.dt.ResponseHeader:console.log("Response header has been received!");break;case m.dt.Response:this.uploadimgbyurltoggle=!1,console.log("Image Uploaded Successfully!",n.body),this.uploadimgbyurlsuccess=!0,this.lessonForm.controls.post_avatar.setValue(n.body.newFilename)}},n=>{console.log("Image not Uploaded!"),this.uploadimgbyurltoggle=!1,this.uploadimgbyurlerror=!0,this.uploadimgbyurlinfo=n.error.message}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(be.c),e.Y36(L.ux),e.Y36(I),e.Y36(P.a),e.Y36(T.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-new-lesson"]],decls:57,vars:14,consts:[[1,"container"],[1,"row"],[1,"col-12","col-lg-8","mb-5","mb-lg-0"],[3,"formGroup"],[1,"col"],[4,"ngIf"],["appearance","legacy"],["type","text","matInput","","formControlName","post_title","maxlength","255"],["theme","snow","formControlName","post_content",3,"modules"],[1,"row","mt-4"],["class","row mt-3",4,"ngIf"],[1,"row","my-3"],[1,"mb-3"],["for","formFile",1,"form-label"],["type","file",1,"form-control",3,"input"],["mode","determinate",3,"value",4,"ngIf"],[1,"mt-3"],[1,"input-group","my-3"],["type","text","aria-describedby","button-addon2",1,"form-control"],["urltreeavatar",""],["type","button","id","button-addon2",1,"btn","btn-outline-secondary",3,"click"],[1,"col-12","col-lg-4"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["mode","query",4,"ngIf"],[1,"row","my-4"],["color","primary","mat-stroked-button","",3,"click"],[1,"fal","fa-long-arrow-left","me-2"],[1,"row","mt-3"],["alt","",2,"height","80px","width","auto",3,"src"],[1,"text-success"],["mode","determinate",3,"value"],["mode","query"],["mat-raised-button","","color","accent",3,"click"]],template:function(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"form",3),e.TgZ(4,"div",1),e.TgZ(5,"div",4),e.YNc(6,ye,5,0,"p",5),e.YNc(7,ve,2,0,"h3",5),e.YNc(8,Ze,2,1,"h3",5),e.qZA(),e.qZA(),e.TgZ(9,"div",1),e.TgZ(10,"div",4),e.TgZ(11,"mat-form-field",6),e.TgZ(12,"mat-label"),e._uU(13," Title "),e.qZA(),e._UZ(14,"input",7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",1),e.TgZ(16,"div",4),e.TgZ(17,"div",0),e._UZ(18,"quill-editor",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",9),e.TgZ(20,"div",4),e.TgZ(21,"mat-card"),e.YNc(22,Te,6,1,"div",10),e.TgZ(23,"div",11),e.TgZ(24,"div",4),e.TgZ(25,"div",12),e.TgZ(26,"label",13),e._uU(27,"Avatar for this lesson (Required)"),e.qZA(),e.TgZ(28,"input",14),e.NdJ("input",function(r){return s.uploadfile(r.target)}),e.qZA(),e.qZA(),e.YNc(29,Ce,3,0,"mat-hint",5),e.YNc(30,Ie,1,1,"mat-progress-bar",15),e.YNc(31,Se,2,1,"mat-error",5),e.TgZ(32,"div",16),e.TgZ(33,"mat-label"),e._uU(34," Or use an image url "),e.qZA(),e.TgZ(35,"div",17),e._UZ(36,"input",18,19),e.TgZ(38,"button",20),e.NdJ("click",function(){e.CHM(i);const r=e.MAs(37);return s.uploadfilebyurl(r.value)}),e._uU(39," Submit "),e.qZA(),e.qZA(),e.YNc(40,we,2,0,"div",5),e.YNc(41,Le,3,0,"mat-hint",5),e.YNc(42,xe,2,1,"mat-error",5),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(43,"div",21),e.TgZ(44,"div",1),e.TgZ(45,"div",4),e._UZ(46,"app-add-lesson-area-selector"),e.qZA(),e.qZA(),e.TgZ(47,"div",1),e.TgZ(48,"div",4),e._UZ(49,"app-add-lesson-category-selector"),e.qZA(),e.qZA(),e.TgZ(50,"div",1),e.TgZ(51,"div",4),e.YNc(52,Ne,2,0,"button",22),e.YNc(53,De,1,0,"mat-progress-bar",23),e.qZA(),e.qZA(),e.TgZ(54,"div",24),e.TgZ(55,"div",4),e._UZ(56,"app-manage-post-table"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(3),e.Q6J("formGroup",s.lessonForm),e.xp6(3),e.Q6J("ngIf",!s.neworedit),e.xp6(1),e.Q6J("ngIf",s.neworedit),e.xp6(1),e.Q6J("ngIf",!s.neworedit),e.xp6(10),e.Q6J("modules",s.modules),e.xp6(4),e.Q6J("ngIf",s.lessonForm.value.post_avatar),e.xp6(7),e.Q6J("ngIf",s.uploadimgbyfilesuccess),e.xp6(1),e.Q6J("ngIf",s.uploadimgbyfiletoggle),e.xp6(1),e.Q6J("ngIf",s.uploadimgbyfileerror),e.xp6(9),e.Q6J("ngIf",s.uploadimgbyurltoggle),e.xp6(1),e.Q6J("ngIf",s.uploadimgbyurlsuccess),e.xp6(1),e.Q6J("ngIf",s.uploadimgbyurlerror),e.xp6(10),e.Q6J("ngIf",!s.publishloading),e.xp6(1),e.Q6J("ngIf",s.publishloading))},styles:[""]}),o})();const Ue=[{path:"",component:ce,children:[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-admin-home-page"]],decls:5,vars:0,consts:[[1,"container","py-5"],[1,"row"],[1,"col"],["mat-raised-button","","color","primary","routerLink","/admin/createlesson"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"button",3),e._uU(4," Manage Lessons "),e.qZA(),e.qZA(),e.qZA(),e.qZA())},directives:[y.lW,S.rH],styles:[""]}),o})()},{path:"createlesson",component:G}]}];let qe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[C.ez,S.Bz.forChild(Ue)],S.Bz]}),o})(),Fe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[C.ez,y.ot,S.Bz]]}),o})();var h=l(2238);let Me=(()=>{class o{constructor(t,s,i,n){this.dialogRef=t,this._api=s,this._snackbar=i,this.store=n}ngOnInit(){}onclose(){this.dialogRef.close()}confirmarea(t){this._api.postAPI({urlsuffix:"addsinglearea",body:{area_name:t}}).then(n=>{this.store.dispatch((0,v.x)()),this.dialogRef.close()}).catch(n=>{this._snackbar.open(n.error.message,"Close")})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.so),e.Y36(P.a),e.Y36(L.ux),e.Y36(T.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-new-area-dialog"]],decls:15,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","fill"],["matInput",""],["areaname",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-raised-button","","cdkFocusInitial","","color","primary",3,"click"]],template:function(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"h1",0),e._uU(1,"Add new area"),e.qZA(),e.TgZ(2,"div",1),e.TgZ(3,"p"),e._uU(4,"Which area do you want to add?"),e.qZA(),e.TgZ(5,"mat-form-field",2),e.TgZ(6,"mat-label"),e._uU(7,"Area name"),e.qZA(),e._UZ(8,"input",3,4),e.qZA(),e.qZA(),e.TgZ(10,"div",5),e.TgZ(11,"button",6),e.NdJ("click",function(){return s.onclose()}),e._uU(12,"Close"),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){e.CHM(i);const r=e.MAs(9);return s.confirmarea(r.value)}),e._uU(14,"Ok"),e.qZA(),e.qZA()}},directives:[h.uh,h.xY,u.KE,u.hX,w.Nt,h.H8,y.lW],styles:[""]}),o})();const Pe=["areaselect"];function $e(o,a){if(1&o&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t.ID),e.xp6(1),e.Oqu(t.area_name)}}let Ee=(()=>{class o{constructor(t,s,i){this.store=t,this.dialog=s,this._localService=i,this.destroy$=new Z.xQ}openAddAreaDialog(){this.dialog.open(Me,{width:"250px"})}ngOnInit(){this._localService.admininfo$.pipe((0,f.R)(this.destroy$),(0,M.n)(t=>!(null==t?void 0:t.admininfo))).subscribe(t=>{this.arealist=t.admininfo.arealist}),this._localService._lessonarea$.pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.areaselect.value=t,this._localService.addlesson.area_ID=t}),this._localService.editlesson$.pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.areaselect.value=void 0,this.emitarea(null)}),this._localService.addlesson.area_ID=null}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}emitarea(t){this._localService.addlesson.area_ID=t,this._localService._lessonarea$.next(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.yh),e.Y36(h.uw),e.Y36(I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-lesson-area-selector"]],viewQuery:function(t,s){if(1&t&&e.Gf(Pe,5),2&t){let i;e.iGM(i=e.CRH())&&(s.areaselect=i.first)}},decls:8,vars:1,consts:[["appearance","legacy"],[3,"selectionChange"],["areaselect",""],[3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,s){1&t&&(e.TgZ(0,"mat-form-field",0),e.TgZ(1,"mat-label"),e._uU(2,"Choose an area"),e.qZA(),e.TgZ(3,"mat-select",1,2),e.NdJ("selectionChange",function(n){return s.emitarea(n.value)}),e.TgZ(5,"mat-option",3),e.NdJ("click",function(){return s.openAddAreaDialog()}),e._uU(6," Add new area "),e.qZA(),e.YNc(7,$e,2,2,"mat-option",4),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngForOf",s.arealist))},directives:[u.KE,u.hX,J.gD,H.ey,C.sg],styles:[""]}),o})(),ke=(()=>{class o{constructor(t,s,i,n,r){this.dialogRef=t,this._api=s,this._snackbar=i,this.store=n,this._localService=r}ngOnInit(){}onclose(){this.dialogRef.close()}confirm(t){let s=this._localService.addlesson.area_ID;s?this._api.postAPI({urlsuffix:"addlessoncategory",body:{category_name:t,area_ID:s}}).then(r=>{this.store.dispatch((0,v.x)()),this.dialogRef.close()}).catch(r=>{this._snackbar.open(r.error.message,"Close")}):(this._snackbar.open("Please choose an area first...","Close"),this.dialogRef.close())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.so),e.Y36(P.a),e.Y36(L.ux),e.Y36(T.yh),e.Y36(I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-category-dialog"]],decls:15,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","fill"],["matInput",""],["catname",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-raised-button","","cdkFocusInitial","","color","primary",3,"click"]],template:function(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"h3",0),e._uU(1,"Add new category"),e.qZA(),e.TgZ(2,"div",1),e.TgZ(3,"p"),e._uU(4,"Which category do you want to add?"),e.qZA(),e.TgZ(5,"mat-form-field",2),e.TgZ(6,"mat-label"),e._uU(7,"Category name"),e.qZA(),e._UZ(8,"input",3,4),e.qZA(),e.qZA(),e.TgZ(10,"div",5),e.TgZ(11,"button",6),e.NdJ("click",function(){return s.onclose()}),e._uU(12,"Close"),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){e.CHM(i);const r=e.MAs(9);return s.confirm(r.value)}),e._uU(14,"Ok"),e.qZA(),e.qZA()}},directives:[h.uh,h.xY,u.KE,u.hX,w.Nt,h.H8,y.lW],styles:[""]}),o})();var k=l(7746);const Re=["list"];function Oe(o,a){if(1&o&&(e.TgZ(0,"mat-list-option",10),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t.ID),e.xp6(1),e.hij(" ",t.category_name," ")}}let Ye=(()=>{class o{constructor(t,s,i){this.store=t,this.dialog=s,this._localService=i,this.destroy$=new Z.xQ}openAddDialog(){this.dialog.open(ke,{width:"250px"})}ngOnInit(){this._localService.admininfo$.pipe((0,f.R)(this.destroy$),(0,M.n)(t=>!(null==t?void 0:t.admininfo))).subscribe(t=>{this.catlist=t.admininfo.lessoncatlist,this.catlist$=this.catlist.filter(s=>s.area_ID==this._localService.addlesson.area_ID)}),this._localService._lessonarea$.pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.catlist$=this.catlist.filter(s=>s.area_ID==t),this._localService.addlesson.cat_ID=[]}),this._localService.editlesson$.pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.matlist.selectedOptions.clear(),this._localService.addlesson.cat_ID=[]}),this._localService.addlesson.cat_ID=[]}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}choosecat(t){this._localService.addlesson.cat_ID=t.map(s=>s.value)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.yh),e.Y36(h.uw),e.Y36(I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-lesson-category-selector"]],viewQuery:function(t,s){if(1&t&&e.Gf(Re,5),2&t){let i;e.iGM(i=e.CRH())&&(s.matlist=i.first)}},decls:15,vars:1,consts:[[1,"row","mt-4"],[1,"col-12"],[1,"mat-small"],[3,"selectionChange"],["list",""],[3,"value",4,"ngFor","ngForOf"],[1,"row","my-3","justify-content-end"],[1,"col-auto"],["color","primary","selected","",3,"click"],[1,"fal","fa-plus","me-2"],[3,"value"]],template:function(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"span",2),e._uU(3,"Category"),e.qZA(),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"mat-selection-list",3,4),e.NdJ("selectionChange",function(){e.CHM(i);const r=e.MAs(6);return s.choosecat(r.selectedOptions.selected)}),e.YNc(7,Oe,2,2,"mat-list-option",5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"div",7),e.TgZ(10,"mat-chip-list"),e.TgZ(11,"mat-chip",8),e.NdJ("click",function(){return s.openAddDialog()}),e._UZ(12,"i",9),e.TgZ(13,"span"),e._uU(14,"Add category"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(7),e.Q6J("ngForOf",s.catlist$))},directives:[k.Ub,C.sg,E.qn,E.HS,k.vS],styles:[""]}),o})();var He=l(8239),R=l(9692),g=l(2789),z=l(8002);function Qe(o,a){1&o&&(e.TgZ(0,"th",15),e._uU(1,"Name"),e.qZA())}function Je(o,a){if(1&o&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.xp6(1),e.Oqu(t.post_title)}}function Be(o,a){1&o&&(e.TgZ(0,"th",17),e._uU(1,"Action"),e.qZA())}function je(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"td",18),e.TgZ(1,"button",19),e._UZ(2,"i",20),e.qZA(),e.TgZ(3,"mat-menu",null,21),e.TgZ(5,"button",22),e.NdJ("click",function(){const n=e.CHM(t).$implicit;return e.oxw().editlesson(n.ID)}),e._uU(6,"Edit"),e.qZA(),e.TgZ(7,"button",22),e.NdJ("click",function(){const n=e.CHM(t).$implicit;return e.oxw().deletelesson(n.ID)}),e._uU(8,"Delete"),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.MAs(4);e.xp6(1),e.Q6J("matMenuTriggerFor",t)}}function Ge(o,a){1&o&&e._UZ(0,"tr",23)}function ze(o,a){1&o&&e._UZ(0,"tr",24)}const Xe=function(){return[5,10,20]};let Ve=(()=>{class o{constructor(t,s,i,n){this.store=t,this._localsService=s,this._APIservice=i,this._snackbar=n,this.destroy$=new Z.xQ,this.displayedColumns=["name","action"],this.dataSource=new g.by([]),this._subDatasource=[]}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}ngOnInit(){var t=this;this._localsService.admininfo$.pipe((0,f.R)(this.destroy$),(0,M.n)(s=>!s),(0,z.U)(s=>s.admininfo.lessons)).subscribe(function(){var s=(0,He.Z)(function*(i){let r=[...i];t.dataSource.data=r.sort((d,_)=>_.ID-d.ID),t._subDatasource=i,setTimeout(()=>t.dataSource.paginator=t.paginator,500)});return function(i){return s.apply(this,arguments)}}())}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase()}editlesson(t){this._localsService.addlesson.neworedit=!1,this._localsService.addlesson.editID=t;let s=this._subDatasource.filter(_=>_.ID===t)[0];var n=(new DOMParser).parseFromString(s.post_content,"text/html").querySelectorAll("img");let r=s.post_content;for(var d=0;d<n.length;d++){let _=n[d].getAttribute("src");r=r.replace(_,D.N.BASE_CDN_URL+"/"+_)}this._localsService.editlesson$.next({post_title:s.post_title,post_content:r,post_category:s.post_category,post_imgarr:[],post_avatar:s.lesson_avatar.media_name})}deletelesson(t){confirm("Are you sure you want to delete this?")&&this._APIservice.postAPI({urlsuffix:"deletesinglelesson",body:{post_ID:t}}).then(n=>{console.log(n),this.store.dispatch((0,v.x)())}).catch(n=>{console.log(n.error),this._snackbar.open(n.error.message,"Close")})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.yh),e.Y36(I),e.Y36(P.a),e.Y36(L.ux))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-manage-post-table"]],viewQuery:function(t,s){if(1&t&&e.Gf(R.NW,5),2&t){let i;e.iGM(i=e.CRH())&&(s.paginator=i.first)}},decls:17,vars:5,consts:[[1,"row","mb-2"],[1,"col"],["appearance","standard"],["matInput","","placeholder","Type something...",3,"keyup"],["input",""],["mat-table","",2,"width","100%",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","style","width: 80%",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","","style","text-align: center",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-header-cell","",2,"width","80%"],["mat-cell",""],["mat-header-cell","",2,"text-align","center"],["mat-cell","",2,"text-align","center"],["mat-button","",3,"matMenuTriggerFor"],[1,"fal","fa-ellipsis-v-alt"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"mat-form-field",2),e.TgZ(3,"mat-label"),e._uU(4,"Post filter"),e.qZA(),e.TgZ(5,"input",3,4),e.NdJ("keyup",function(n){return s.applyFilter(n)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"table",5),e.ynx(8,6),e.YNc(9,Qe,2,0,"th",7),e.YNc(10,Je,2,1,"td",8),e.BQk(),e.ynx(11,9),e.YNc(12,Be,2,0,"th",10),e.YNc(13,je,9,1,"td",11),e.BQk(),e.YNc(14,Ge,1,0,"tr",12),e.YNc(15,ze,1,0,"tr",13),e.qZA(),e._UZ(16,"mat-paginator",14)),2&t&&(e.xp6(7),e.Q6J("dataSource",s.dataSource),e.xp6(7),e.Q6J("matHeaderRowDef",s.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",s.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(4,Xe)))},directives:[u.KE,u.hX,w.Nt,g.BZ,g.w1,g.fO,g.Dz,g.as,g.nj,R.NW,g.ge,g.ev,y.lW,x.p6,x.VK,x.OP,g.XQ,g.Gk],styles:[""]}),o})();var $=l(9959),We=l(3190),Ke=l(1974),et=l(5817);let tt=(()=>{class o{constructor(t){this.apollo=t,this.getadmininfoapi=this.apollo.watchQuery({query:Ke.Ps`
          {
            admininfo
            {
              lessons {
                ID,
                post_title,
                post_content,
                post_date,
                post_category,
                post_avatar {
                  media_name,
                  media_path
                }
              },
              arealist {
                ID,
                area_name
              },
              lessoncatlist {
                ID,
                category_name,
                area_ID
              },
              report_loggers {
                ID,
                report_notes,
                report_date,
                report_sender,
                report_controllers,
                parent_ID,
                report_type,
                finished
              },
              defaultconfig {
                postimg_path,
                default_post_avatar
              }
            }
          }
          `}).valueChanges}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(et._M))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),ot=(()=>{class o{constructor(t,s){this.action$=t,this._adminapi=s,this.getadmininfo$=(0,$.GW)(()=>this.action$.pipe((0,$.l4)(v.x),(0,We.w)(()=>this._adminapi.getadmininfoapi.pipe((0,z.U)(i=>(0,v.i)({admininfo:i.data.admininfo}))))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG($.eX),e.LFG(tt))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),st=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[C.ez,qe,Fe,N.SJ,Y.QW,y.ot,x.Tx,ae.kz,p.UX,u.lN,Q.Cv,ee.FA,H.XK,K.p9,J.LD,V.Bb,w.c,oe.To,W.g,L.ZX,se.AV,E.Hi,te.t,h.Is,g.p0,R.TU,k.ie,B.fi.forRoot(),$.sQ.forFeature([ot])]]}),o})();e.B6R(G,[p._Y,p.JL,p.sg,C.O5,y.lW,u.KE,u.hX,w.Nt,p.Fj,p.JJ,p.u,p.nD,B.g6,Y.a8,u.bx,Q.pW,u.TO,Ee,Ye,Ve],[])}}]);